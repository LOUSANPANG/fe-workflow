---
title: 'Commitizen&Commitlint'
description: 'Commitizen&Commitlinté…ç½®ä½¿ç”¨æŒ‡å—'
---

# Commitizen & Commitlint

## 1 commitizen & cz-conventional-changelog è§„èŒƒæäº¤ä¿¡æ¯æ ¼å¼

#### 1.1 å®‰è£…ã€é…ç½®ä¾èµ–

```bash
# git cz æ›¿ä»£ git commitï¼Œç”Ÿæˆç¬¦åˆè§„èŒƒçš„ commit messageã€‚
pnpm add commitizen -D

# ä¸€ä¸ªç¬¦åˆ Angular å›¢é˜Ÿè§„èŒƒçš„ presetï¼ŒæŒ‰ç…§æˆ‘ä»¬æŒ‡å®šçš„è§„èŒƒç”Ÿæˆ commit messageã€‚
pnpm add cz-conventional-changelog -D


# ã€å…¨å±€æ¨¡å¼ã€‘ä¸‹, éœ€è¦ ~/.czrc é…ç½®æ–‡ä»¶, ä¸º commitizen æŒ‡å®š Adapterã€‚
echo '{ "path": "cz-conventional-changelog" }' > ~/.czrc

# ã€é¡¹ç›®çº§é…ç½®ã€‘ä¸‹
# package.json
{
  "script": {
    "commit": "git-cz",
  },
  "config": {
    "commitizen": {
      "path": "node_modules/cz-conventional-changelog"
    }
  }
}
```

#### 1.2 è‡ªå®šä¹‰ Adapter

```bash
# æŒ‡å®šä¸€å¥—ç¬¦åˆè‡ªå·±å›¢é˜Ÿçš„è§„èŒƒä»£æ›¿ Angular è§„èŒƒ
pnpm add cz-customizable -D

# package.json æŒ‡å®šé…ç½®
{
  "config": {
    "commitizen": {
      "path": "node_modules/cz-customizable"
    }
  }
}
# ===> æˆ–è€…é…ç½® .czrc æ–‡ä»¶
{ "path": "cz-customizable" }
```

#### 1.3 é…ç½® .cz-config.js

```js
'use strict'
module.exports = {
  messages: {
    type: 'é€‰æ‹©ä½ è¦æäº¤çš„ç±»å‹ :',
    scope: 'é€‰æ‹©ä¸€ä¸ªæäº¤èŒƒå›´ï¼ˆå¯é€‰ï¼‰:',
    customScope: 'è¯·è¾“å…¥è‡ªå®šä¹‰çš„æäº¤èŒƒå›´ :',
    subject: 'å¡«å†™ç®€çŸ­ç²¾ç‚¼çš„å˜æ›´æè¿° :\n',
    body: 'å¡«å†™æ›´åŠ è¯¦ç»†çš„å˜æ›´æè¿°ï¼ˆå¯é€‰ï¼‰ã€‚ä½¿ç”¨ "|" æ¢è¡Œ :\n',
    breaking: 'åˆ—ä¸¾éå…¼å®¹æ€§é‡å¤§çš„å˜æ›´ï¼ˆå¯é€‰ï¼‰ã€‚ä½¿ç”¨ "|" æ¢è¡Œ :\n',
    footerPrefixsSelect: 'é€‰æ‹©å…³è”issueå‰ç¼€ï¼ˆå¯é€‰ï¼‰:',
    customFooterPrefixs: 'è¾“å…¥è‡ªå®šä¹‰issueå‰ç¼€ :',
    footer: 'åˆ—ä¸¾å…³è”issue (å¯é€‰) ä¾‹å¦‚: #31, #I3244 :\n',
    confirmCommit: 'æ˜¯å¦æäº¤æˆ–ä¿®æ”¹commit ?',
  },

  types: [
    { value: 'feat', name: 'feat:     âœ¨  æ–°å¢åŠŸèƒ½', emoji: ':sparkles:' },
    { value: 'fix', name: 'fix:     ğŸ›  ä¿®å¤ bug', emoji: ':bug:' },
    { value: 'docs', name: 'docs:     ğŸ“  æ–‡æ¡£å˜æ›´', emoji: ':memo:' },
    {
      value: 'style',
      name: 'style:     ğŸ’„  ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼Œä¾‹å¦‚ç©ºæ ¼ã€åˆ†å·ç­‰æ ¼å¼ä¿®æ­£ï¼‰',
      emoji: ':lipstick:',
    },
    {
      value: 'refactor',
      name: 'refactor:     â™»ï¸  ä»£ç é‡æ„ï¼ˆä¸åŒ…æ‹¬ bug ä¿®å¤ã€åŠŸèƒ½æ–°å¢ï¼‰',
      emoji: ':recycle:',
    },
    { value: 'perf', name: 'perf:     âš¡ï¸  æ€§èƒ½ä¼˜åŒ–', emoji: ':zap:' },
    { value: 'test', name: 'test:     âœ…  æ·»åŠ ã€ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹', emoji: ':white_check_mark:' },
    {
      value: 'build',
      name: 'build:     ğŸ“¦ï¸  æ„å»ºæµç¨‹ã€å¤–éƒ¨ä¾èµ–å˜æ›´ï¼ˆå¦‚å‡çº§ npm åŒ…ã€ä¿®æ”¹ webpack é…ç½®ç­‰ï¼‰',
      emoji: ':package:',
    },
    { value: 'ci', name: 'ci:     ğŸ‘·  ä¿®æ”¹ CI é…ç½®ã€è„šæœ¬', emoji: ':construction_worker:' },
    {
      value: 'chore',
      name: 'chore:     ğŸ”¨  å¯¹æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å’Œåº“çš„æ›´æ”¹ï¼ˆä¸å½±å“æºæ–‡ä»¶ã€æµ‹è¯•ç”¨ä¾‹ï¼‰',
      emoji: ':hammer:',
    },
    { value: 'revert', name: 'revert:     âªï¸  å›æ»š commit', emoji: ':rewind:' },
  ],

  scopes: [
    ['view', 'é¡µé¢ç›¸å…³'],
    ['components', 'ç»„ä»¶ç›¸å…³'],
    ['utils', 'utils ç›¸å…³'],
    ['styles', 'æ ·å¼ç›¸å…³'],
    ['deps', 'é¡¹ç›®ä¾èµ–'],
    ['workflows', 'éƒ¨ç½²ç›¸å…³'],
    ['md', 'æ–‡æ¡£ç›¸å…³'],
    ['other', 'å…¶ä»–ä¿®æ”¹'],
    ['custom', 'ä»¥ä¸Šéƒ½ä¸æ˜¯ï¼Ÿæˆ‘è¦è‡ªå®šä¹‰'], // å¦‚æœé€‰æ‹© customï¼Œåé¢ä¼šè®©ä½ å†è¾“å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„ scopeã€‚ä¹Ÿå¯ä»¥ä¸è®¾ç½®æ­¤é¡¹ï¼ŒæŠŠåé¢çš„ allowCustomScopes è®¾ç½®ä¸º true
  ].map(([value, description]) => {
    return {
      value,
      name: `${value.padEnd(30)} (${description})`,
    }
  }),

  subjectLimit: 100, // subject é™åˆ¶é•¿åº¦
  useEmoji: true,
  emojiAlign: 'center',
  themeColorCode: '',
  allowCustomScopes: true, // æ˜¯å¦å…è®¸è‡ªå®šä¹‰å¡«å†™ scopeï¼Œåœ¨ scope é€‰æ‹©çš„æ—¶å€™ï¼Œä¼šæœ‰ empty å’Œ custom å¯ä»¥é€‰æ‹©ã€‚
  allowEmptyScopes: true,
  customScopesAlign: 'bottom',
  customScopesAlias: 'ä»¥ä¸Šéƒ½ä¸æ˜¯ï¼Ÿæˆ‘è¦è‡ªå®šä¹‰',
  emptyScopesAlias: 'è·³è¿‡',
  upperCaseSubject: false,
  markBreakingChangeMode: false,
  allowBreakingChanges: ['feat', 'fix'], // è®¾ç½®åªæœ‰ type é€‰æ‹©äº† feat æˆ– fixï¼Œæ‰è¯¢é—® breaking message
  breaklineNumber: 100,
  breaklineChar: '|', //  // æ”¯æŒ body å’Œ footer
  // skipQuestions: ['body', 'footer'], // è·³è¿‡è¦è¯¢é—®çš„æ­¥éª¤
  // issuePrefixs: [ // å¦‚æœä½¿ç”¨ gitee ä½œä¸ºå¼€å‘ç®¡ç†
  //   { value: 'link', name: 'link:     é“¾æ¥ ISSUES è¿›è¡Œä¸­' },
  //   { value: 'closed', name: 'closed:   æ ‡è®° ISSUES å·²å®Œæˆ' }
  // ],
  customIssuePrefixsAlign: 'top',
  emptyIssuePrefixsAlias: 'è·³è¿‡',
  customIssuePrefixsAlias: 'è‡ªå®šä¹‰å‰ç¼€',
  allowCustomIssuePrefixs: true,
  allowEmptyIssuePrefixs: true,
  confirmColorize: true,
  maxHeaderLength: Infinity,
  maxSubjectLength: Infinity,
  minSubjectLength: 0,
  // scopeOverrides: { // é’ˆå¯¹æ¯ä¸€ä¸ª type å»å®šä¹‰å¯¹åº”çš„ scopesï¼Œä¾‹å¦‚ fix
  //   fix: [
  //     {name: 'merge'},
  //     {name: 'style'},
  //     {name: 'e2eTest'},
  //     {name: 'unitTest'}
  //   ]
  // },
  defaultBody: '',
  defaultIssues: '',
  defaultScope: '',
  defaultSubject: '',
}
```

## 2 commitlint æ ¡éªŒæäº¤ä¿¡æ¯

```bash
# lint commit messages
pnpm add @commitlint/cli -D

# ä¸€ä»½ç¬¦åˆ Angular å›¢é˜Ÿè§„èŒƒæ ¡éªŒçš„é…ç½®
pnpm add @commitlint/config-conventional -D

# å¯¹è‡ªå®šä¹‰çš„ Adapter è¿›è¡Œæ£€æµ‹
pnpm add commitlint-config-cz -D
```

#### 2.1 é…ç½® .commitlintrc

```json
{
  "extends": [
    - "@commitlint/config-conventional" // é»˜è®¤ commitizen adapter
    + "cz" // è‡ªå®šä¹‰ commitizen adapter
  ],
  "rules": {}
}
```

## 3 ç»“åˆ Husky

```bash
npx husky add .husky/commit-msg  "npx --no -- commitlint --edit ${1}"
```




## å¸¸è§é—®é¢˜


**error: gHusky pre-commit fails with code 1**

1ã€è§£å†³ï¼š`git config --unset core.hooksPath`

2ã€[æ–¹æ¡ˆé“¾æ¥](https://github.com/typicode/husky/issues/1014){.doclink}
