---
title: 'Commitizen&Commitlint'
description: 'Commitizen&Commitlinté…ç½®ä½¿ç”¨æŒ‡å—'
---


# Commitizen & Commitlint




## 1 commitizen & cz-conventional-changelog è§„èŒƒæäº¤ä¿¡æ¯æ ¼å¼


#### 1.1 å®‰è£…ã€é…ç½®ä¾èµ–

```bash
# git cz æ›¿ä»£ git commitï¼Œç”Ÿæˆç¬¦åˆè§„èŒƒçš„ commit messageã€‚
pnpm add commitizen -D

# ä¸€ä¸ªç¬¦åˆ Angular å›¢é˜Ÿè§„èŒƒçš„ presetï¼ŒæŒ‰ç…§æˆ‘ä»¬æŒ‡å®šçš„è§„èŒƒç”Ÿæˆ commit messageã€‚
pnpm add cz-conventional-changelog -D


# ã€å…¨å±€æ¨¡å¼ã€‘ä¸‹, éœ€è¦ ~/.czrc é…ç½®æ–‡ä»¶, ä¸º commitizen æŒ‡å®š Adapterã€‚
echo '{ "path": "cz-conventional-changelog" }' > ~/.czrc

# ã€é¡¹ç›®çº§é…ç½®ã€‘ä¸‹
# package.json
{
  "script": {
    "commit": "git-cz",
  },
  "config": {
    "commitizen": {
      "path": "node_modules/cz-conventional-changelog"
    }
  }
}

# ===> æˆ–è€…ä½¿ç”¨å‘½ä»¤ä»£æ›¿
npm set-script commit "git-cz"
npx commitizen init cz-conventional-changelog --save-dev --save-exact --force
```


#### 1.2 è‡ªå®šä¹‰ Adapter

```bash
# æŒ‡å®šä¸€å¥—ç¬¦åˆè‡ªå·±å›¢é˜Ÿçš„è§„èŒƒä»£æ›¿ Angular è§„èŒƒ
pnpm add cz-customizable -D

# package.json æŒ‡å®šé…ç½®
{
  "config": {
    "commitizen": {
      "path": "node_modules/cz-customizable"
    }
  }
}
# ===> æˆ–è€…é…ç½® .czrc æ–‡ä»¶
{ "path": "cz-customizable" }
```


#### 1.3 é…ç½® .cz-config.js

```js
'use strict'
module.exports = {
  // type ç±»åž‹
  types: [
    { value: 'âœ¨feat', name: 'feat: æ–°å¢žå†…å®¹' },
    { value: 'ðŸ›fix', name: 'fix: ä¿®å¤Bug' },
    { value: 'ðŸ“docs', name: 'docs: æ–‡æ¡£å˜æ›´' },
    { value: 'ðŸ’„style', name: 'style: ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼Œä¾‹å¦‚ç©ºæ ¼ã€åˆ†å·ç­‰æ ¼å¼ä¿®æ­£ï¼‰' },
    { value: 'â™»ï¸refactor', name: 'refactor: ä»£ç é‡æž„ï¼ˆä¸åŒ…æ‹¬ bug ä¿®å¤ã€åŠŸèƒ½æ–°å¢žï¼‰' },
    { value: 'âš¡ï¸perf', name: 'perf: æ€§èƒ½ä¼˜åŒ–' },
    { value: 'âœ…test', name: 'test: æ·»åŠ ã€ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹' },
    {
      value: 'ðŸ“¦ï¸build',
      name: 'build: æž„å»ºæµç¨‹ã€å¤–éƒ¨ä¾èµ–å˜æ›´ï¼ˆå¦‚å‡çº§ npm åŒ…ã€ä¿®æ”¹ webpack é…ç½®ç­‰ï¼‰',
    },
    { value: 'ðŸ”¨ci', name: 'ci: ä¿®æ”¹ CI é…ç½®ã€è„šæœ¬' },
    { value: 'ðŸ”§chore', name: 'chore: å¯¹æž„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å’Œåº“çš„æ›´æ”¹ï¼ˆä¸å½±å“æºæ–‡ä»¶ã€æµ‹è¯•ç”¨ä¾‹ï¼‰' },
    { value: 'âªrevert', name: 'revert: å›žæ»š commit' }
  ],

  // é’ˆå¯¹æ¯ä¸€ä¸ª type åŽ»å®šä¹‰å¯¹åº”çš„ scopesï¼Œä¾‹å¦‚ fix
  // scopeOverrides: {
  //   fix: [
  //     {name: 'merge'},
  //     {name: 'style'},
  //     {name: 'e2eTest'},
  //     {name: 'unitTest'}
  //   ]
  // },

  // scope ç±»åž‹
  scopes: [
    ['view', 'é¡µé¢ç›¸å…³'],
    ['components', 'ç»„ä»¶ç›¸å…³'],
    ['utils', 'utils ç›¸å…³'],
    ['styles', 'æ ·å¼ç›¸å…³'],
    ['deps', 'é¡¹ç›®ä¾èµ–'],
    ['workflows', 'éƒ¨ç½²ç›¸å…³'],
    ['md', 'æ–‡æ¡£ç›¸å…³'],
    ['other', 'å…¶ä»–ä¿®æ”¹'],
    // å¦‚æžœé€‰æ‹© customï¼ŒåŽé¢ä¼šè®©ä½ å†è¾“å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„ scopeã€‚ä¹Ÿå¯ä»¥ä¸è®¾ç½®æ­¤é¡¹ï¼ŒæŠŠåŽé¢çš„ allowCustomScopes è®¾ç½®ä¸º true
    ['custom', 'ä»¥ä¸Šéƒ½ä¸æ˜¯ï¼Ÿæˆ‘è¦è‡ªå®šä¹‰'],
  ].map(([value, description]) => {
    return {
      value,
      name: `${value.padEnd(30)} (${description})`,
    }
  }),

  // æ˜¯å¦å…è®¸è‡ªå®šä¹‰å¡«å†™ scopeï¼Œåœ¨ scope é€‰æ‹©çš„æ—¶å€™ï¼Œä¼šæœ‰ empty å’Œ custom å¯ä»¥é€‰æ‹©ã€‚
  // allowCustomScopes: true,

  // allowTicketNumber: false,
  // isTicketNumberRequired: false,
  // ticketNumberPrefix: 'TICKET-',
  // ticketNumberRegExp: '\\d{1,5}',

  // äº¤äº’æç¤ºä¿¡æ¯
  messages: {
    type: 'ç¡®ä¿æœ¬æ¬¡æäº¤éµå¾ª Angular è§„èŒƒï¼\né€‰æ‹©ä½ è¦æäº¤çš„ç±»åž‹ï¼š',
    scope: '\né€‰æ‹©ä¸€ä¸ª scopeï¼ˆå¯é€‰ï¼‰ï¼š',
    customScope: 'è¯·è¾“å…¥è‡ªå®šä¹‰çš„ scopeï¼š',
    subject: 'å¡«å†™ç®€çŸ­ç²¾ç‚¼çš„å˜æ›´æè¿°ï¼š\n',
    body: 'å¡«å†™æ›´åŠ è¯¦ç»†çš„å˜æ›´æè¿°ï¼ˆå¯é€‰ï¼‰ã€‚ä½¿ç”¨ "|" æ¢è¡Œï¼š\n',
    breaking: 'åˆ—ä¸¾éžå…¼å®¹æ€§é‡å¤§çš„å˜æ›´ï¼ˆå¯é€‰ï¼‰ï¼š\n',
    footer: 'åˆ—ä¸¾å‡ºæ‰€æœ‰å˜æ›´çš„ ISSUES CLOSEDï¼ˆå¯é€‰ï¼‰ã€‚ ä¾‹å¦‚: #1, #2ï¼š\n',
    confirmCommit: 'ç¡®è®¤æäº¤ï¼Ÿ',
  },

  // è®¾ç½®åªæœ‰ type é€‰æ‹©äº† feat æˆ– fixï¼Œæ‰è¯¢é—® breaking message
  allowBreakingChanges: ['feat', 'fix'],

  // è·³è¿‡è¦è¯¢é—®çš„æ­¥éª¤
  // skipQuestions: ['body', 'footer'],

  // subject é™åˆ¶é•¿åº¦
  subjectLimit: 100,
  breaklineChar: '|', // æ”¯æŒ body å’Œ footer
  // footerPrefix : 'ISSUES CLOSED:'
  // askForBreakingChangeFirst : true,
}
```




## 2 commitlint æ ¡éªŒæäº¤ä¿¡æ¯

```bash
# lint commit messages
pnpm add @commitlint/cli -D

# ä¸€ä»½ç¬¦åˆ Angular å›¢é˜Ÿè§„èŒƒæ ¡éªŒçš„é…ç½®
pnpm add @commitlint/config-conventional -D

# å¯¹è‡ªå®šä¹‰çš„ Adapter è¿›è¡Œæ£€æµ‹
pnpm add commitlint-config-cz -D
```


#### 2.1 é…ç½® .commitlintrc

```json
{
  "extends": [
    - "@commitlint/config-conventional" // é»˜è®¤ commitizen adapter
    + "cz" // è‡ªå®šä¹‰ commitizen adapter
  ],
  "rules": {}
}
```




## 3 ç»“åˆ Husky

```json
// package.json
{
  "husky": {
    "hooks": {
      "commit-msg": "commitlint -e $GIT_PARAMS"
    }
  }
}

// ===> æˆ–è€…ç”¨å‘½ä»¤ä»£æ›¿
npx husky add .husky/commit-msg 'npx --no-install commitlint --edit "$1"'
```
