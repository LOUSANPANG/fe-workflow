{"_path":"/docs/opt-css","_dir":"docs","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"CSS 代码优化","description":"CSS 代码优化","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"css-代码优化"},"children":[{"type":"text","value":"CSS 代码优化"}]},{"type":"element","tag":"h2","props":{"id":"css-代码方面"},"children":[{"type":"text","value":"CSS 代码方面"}]},{"type":"element","tag":"h4","props":{"id":"html-节点尽量少避免深层次嵌套结构"},"children":[{"type":"text","value":"HTML 节点尽量少，避免深层次嵌套结构"}]},{"type":"element","tag":"h4","props":{"id":"内联首屏关键-css"},"children":[{"type":"text","value":"内联首屏关键 CSS"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"内联在页面的  标签中，从而减少往返请求传输。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"由于在慢启动阶段 TCP 交换的包的大小有限，所以关键 CSS 的大小应该不超过14KB。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"超出这个限制范围，浏览器将需要额外的传输往返用于获取更多样式。"}]}]},{"type":"element","tag":"h4","props":{"id":"css-不同情况下的引用情况"},"children":[{"type":"text","value":"CSS 不同情况下的引用情况"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"媒体查询条件把 CSS 文件进行拆分可能对我们的页面性能有一定提升（不同 media 适配，引入不同的 CSS 文件）。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"避免在 CSS 文件中使用 @import，会影响浏览器的并行下载。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"使用 scss、less 他们会将 @import 的文件直接包含在 CSS 中，并不会产生额外的 HTTP 请求。"}]}]},{"type":"element","tag":"h4","props":{"id":"有选择地使用选择器"},"children":[{"type":"text","value":"有选择地使用选择器"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CSS 选择器的匹配是从右向左进行的。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"嵌套的层级更多，匹配所要花费的时间代价自然更高。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"通配符和属性选择器效率最低。"}]}]},{"type":"element","tag":"h4","props":{"id":"减少回流和重绘"},"children":[{"type":"text","value":"减少回流和重绘"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"始终在图像上设置宽度和高度属性，浏览器保留空间，后续图片资源加载完成后不需要回流。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"避免多次修改 DOM 属性，批量修改 DOM。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"脱离文档流：对于一些类似动画之类的频繁变更的 DOM.可以使用绝对定位将其脱离文档流，避免父元素频繁回流。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"渲染层提升为合成层"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"合成层的位图，会交由 GPU 合成，比 CPU 处理要快得多。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"当需要重绘时，只需要重绘本身，不会影响到其他的层。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"元素提升为合成层后，transform 和 opacity 才不会触发重绘，如果不是合成层，则其依然会触发重绘。"}]}]},{"type":"element","tag":"code","props":{"className":["language-css"],"code":"  <!-- left、top 改为 transform -->\n  @keyframes heartbeat{\n    0%{top:30px;left:30px;}\n    100%{top:230px;left:30px;}\n   }\n   @keyframes heartbeat{\n      0%{transform: translate(30px,30px);}\n      100%{transform: translate(230px,30px);}\n   }\n\n   <!-- transform 属性会启用硬件加速 -->\n   .box { box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);}\n   .box { transform: translateZ(0);  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);}\n","language":"css","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"  <!-- left、top 改为 transform --"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"@keyframes"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-260919"},"children":[{"type":"text","value":"heartbeat"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0%"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"top"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"left"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":";}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"100%"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"top"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"230"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"left"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":";}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"   }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"   "}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"@keyframes"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-260919"},"children":[{"type":"text","value":"heartbeat"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0%"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"transform"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"translate"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":");}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"100%"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"transform"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"translate"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"230"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":");}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"   }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"   <!-- transform 属性会启用硬件加速 --"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"   "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":".box"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"box-shadow"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"rgba"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0.5"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":");}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"   "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":".box"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"transform"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"translateZ"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":");  "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"box-shadow"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"rgba"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0.5"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":");}"}]}]}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"提升渲染性能的css属性"},"children":[{"type":"text","value":"提升渲染性能的CSS属性"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"content-visibility 控制一个元素是否渲染其内容，并且允许浏览器跳过这些元素的布局与渲染。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"will-change 通知浏览器哪些元素和属性将会改变。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"contain-intrinsic-size 指定的元素自然大小，确保我们未渲染子元素的 div 仍然占据空间。"}]}]},{"type":"element","tag":"code","props":{"className":["language-css"],"code":"  .u-box {\n    opacity: 1;\n    transition: opacity 0.3s ease;\n    will-change: opacity; /* 告知浏览器我们将会修改透明度 */\n  }\n","language":"css","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":".u-box"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"opacity"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"transition"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":": opacity "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"0.3"}]},{"type":"element","tag":"span","props":{"class":"ct-560933"},"children":[{"type":"text","value":"s"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"ease"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-805492"},"children":[{"type":"text","value":"will-change"}]},{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":": opacity; "}]},{"type":"element","tag":"span","props":{"class":"ct-818532"},"children":[{"type":"text","value":"/* 告知浏览器我们将会修改透明度 */\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-753911"},"children":[{"type":"text","value":"  }"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-753911{color:#ADBAC7;}\n.ct-560933{color:#F47067;}\n.ct-260919{color:#F69D50;}\n.ct-805492{color:#6CB6FF;}\n.ct-818532{color:#768390;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"css-代码方面","depth":2,"text":"CSS 代码方面"}]}},"_type":"markdown","_id":"content:docs:72.opt-css.md","_source":"content","_file":"docs/72.opt-css.md","_extension":"md"}