{"_path":"/docs/github-action","_dir":"docs","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Github自动化部署","description":"Github自动化部署","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"github-actions-自动化部署"},"children":[{"type":"text","value":"GitHub Actions 自动化部署"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"class":"doclink","href":"https://github.com/marketplace?type=actions","rel":["nofollow"]},"children":[{"type":"text","value":"Actions 市场"}]}]},{"type":"element","tag":"h2","props":{"id":"设置仓库密钥"},"children":[{"type":"text","value":"设置仓库密钥"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"在项目仓库找到 Settings/Secrets/Actions"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"New repository secret"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"填写 New secret 的 Name* 和 Secret*"}]}]},{"type":"element","tag":"h2","props":{"id":"配置域名地址"},"children":[{"type":"text","value":"配置域名地址"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"package.json 添加 homepage 字段"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"\"homepage\": \"https://"},{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"username"}]},{"type":"text","value":".github.io/"},{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"route"}]},{"type":"text","value":"\""}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"username"}]},{"type":"text","value":" 为你的 GitHub 用户名"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"route"}]},{"type":"text","value":" 项目路由 例如 fe-workflow"}]}]},{"type":"element","tag":"h2","props":{"id":"配置-ci"},"children":[{"type":"text","value":"配置 CI"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"创建 .github/workflows 目录，新增 ci.yml"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"选用 JamesIves/github-pages-deploy-action 范例文件"}]}]},{"type":"element","tag":"code","props":{"code":"name: fe-workflow Deploy\n\n# 整个流程在master分支发生push事件时触发\non:\n  push:\n    branches: [master]\n  pull_request:\n    branches: [master]\n\njobs:\n  # 只有一个job，运行在虚拟机环境 ubuntu-latest\n  build-and-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      # 第一步是获取源码，使用 actions/checkout命令\n      - name: Checkout\n        uses: actions/checkout@v2\n        with:\n          persist-credentials: false\n\n      # 第二步 打包构建项目\n      - name: Generate\n        run: |\n          npm install\n          npm run build\n          npm run generate\n\n      # 第三步是构建和部署，使用 amesIves/github-pages-deploy-action@releases/v3 命令\n      # 需要三个环境变量，分别为 GitHub 密钥、发布分支、构建成果所在目录。其中，只有 GitHub 密钥是秘密变量，需要写在双括号里面，其余都可以直接写在文件里\n      - name: Deploy\n        uses: JamesIves/github-pages-deploy-action@releases/v3\n        with:\n          ACCESS_TOKEN: ${{ secrets.xxx }}\n          BRANCH: gh-pages\n          FOLDER: dist\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"name:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"fe-workflow"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"Deploy"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-99b07a"},"children":[{"type":"text","value":"# 整个流程在master分支发生push事件时触发"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"on:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"push:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"branches:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" [master]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"pull_request:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"branches:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" [master]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9d0efe"},"children":[{"type":"text","value":"jobs"}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-99b07a"},"children":[{"type":"text","value":"# 只有一个job，运行在虚拟机环境 ubuntu-latest"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"build-and-deploy:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"runs-on:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"ubuntu-latest"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"steps:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-99b07a"},"children":[{"type":"text","value":"# 第一步是获取源码，使用 actions/checkout命令"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"name:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"Checkout"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"uses:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"actions/checkout@v2"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"with:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"persist-credentials:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-9d0efe"},"children":[{"type":"text","value":"false"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-99b07a"},"children":[{"type":"text","value":"# 第二步 打包构建项目"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"name:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"Generate"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"run:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-69f338"},"children":[{"type":"text","value":"|"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"install"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"run"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"build"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"run"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"generate"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-99b07a"},"children":[{"type":"text","value":"# 第三步是构建和部署，使用 amesIves/github-pages-deploy-action@releases/v3 命令"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-99b07a"},"children":[{"type":"text","value":"# 需要三个环境变量，分别为 GitHub 密钥、发布分支、构建成果所在目录。其中，只有 GitHub 密钥是秘密变量，需要写在双括号里面，其余都可以直接写在文件里"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"name:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"Deploy"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"uses:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"JamesIves/github-pages-deploy-action@releases/v3"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"with:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"ACCESS_TOKEN:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" ${{ secrets.xxx }"}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"BRANCH:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"gh-pages"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-f9e7fc"},"children":[{"type":"text","value":"FOLDER:"}]},{"type":"element","tag":"span","props":{"class":"ct-cb9ac3"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d65de"},"children":[{"type":"text","value":"dist"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-69f338{color:#F47067}\n.ct-9d0efe{color:#6CB6FF}\n.ct-99b07a{color:#768390}\n.ct-3d65de{color:#96D0FF}\n.ct-cb9ac3{color:#ADBAC7}\n.ct-f9e7fc{color:#F69D50}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"设置仓库密钥","depth":2,"text":"设置仓库密钥"},{"id":"配置域名地址","depth":2,"text":"配置域名地址"},{"id":"配置-ci","depth":2,"text":"配置 CI"}]}},"_type":"markdown","_id":"content:docs:152.github-action.md","_source":"content","_file":"docs/152.github-action.md","_extension":"md"}